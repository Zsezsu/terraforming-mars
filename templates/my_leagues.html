{% extends 'layout/layout.html' %}

{% block title %}My Leagues{% endblock %}

{% block script %}
    <script type="module" src="{{ url_for('static', filename='js/addLeague.js') }}" defer></script>
    <script type="module" src="{{ url_for('static', filename='js/addLeagueTransition.js') }}" defer></script>
    <script type="module" src="{{ url_for('static', filename='js/leagueSlideshow.js') }}" defer></script>
{% endblock %}

{% block nav_games %}active{% endblock %}

{% block content %}
    <h1 class="text-center text-light">My Leagues</h1>
    <div class="header">
        <button id="new-league" class="btn btn-light">
            Add new league
        </button>
    </div>
    <div id="add-league" class="card league bg-dark new-league hide-new-league">
        <div id="league-form">
            <h2 class="text-light">Add new league</h2>
            <label class="text-light" for="league-name">League Name</label><br>
            <input type="text" id="league-name" name="league-name" placeholder="Enter the league's name"><br>
            <label class="text-light" for="league-rounds">Number of Rounds</label><br>
            <input type="number" id="league-rounds" name="league-rounds" min="1" max="10"
                   placeholder="Choose the number of rounds between 1-10"><br>
            <label id="label-league-players" class="text-light" for="league-players">League Players 1/5</label><br>
            <input type="text" id="league-players" name="league-players" placeholder="Add new players to league"><br>
            <div id="selected-players" class="player-container bg-dark">
                {% set user_id = logged_in_user['id'] %}
                {% set username = logged_in_user['username'] %}
                {% set name = logged_in_user['name'] %}
                {% set img_source = logged_in_user['image_source'] %}
                <div class="player-card card bg-dark" data-player-id="{{ user_id }}">
                    <img alt="Profile picture of {{ username }}"
                         src="{{ url_for('static', filename='img/league_cards/mars-1.webp') }}">
                    <div class="player-card-description">
                        <p>{{ name }}</p>
                        <small>{{ username }}</small>
                    </div>
                </div>
            </div>
            <div id="searched-players"></div>
            <button id="button-confirm" class="btn btn-light" type="button">Confirm</button>
            <br>
            <button id="button-close" class="btn btn-dark" type="button">Close</button>
        </div>
        <div class="league-separator"></div>
        <div id="league-slideshow">
            <h2 class="text-center text-light">Choose an image</h2>
            <div class="new-league-images text-light">
                <img id="slideshow-image" alt="league background">
                <i class="fa-solid fa-angle-left text-light slideshow-button" id="slideshow-previous"></i>
                <i class="fa-solid fa-angle-right text-light slideshow-button" id="slideshow-next"></i>
            </div>
        </div>
    </div>
    <div class="leagues cards">
        {% for league in leagues %}
            {% set league_id = league['id'] %}
            {% set league_name = league['league_name'] %}
            {% set league_admin_id = league['league_admin'] %}
            {% set number_of_rounds = league['round_number'] %}
            {% set player_number = league['player_number'] %}
            {% set finished_rounds = league['finished_rounds'] %}
            {% set img_source = league['league_image_source'] %}

            <div class="card league bg-dark" data-league-id="{{ league_id }}" data-league-admin-id="{{ league_admin_id }}">
                <img alt="mars" src="{{ url_for('static', filename=img_source) }}">
                <h3 class="text-light">{{ league_name }}</h3>
                <div class="card-details">
                    <small class="text-light">{{ player_number }}</small>
                    <i class="fa-solid fa-user-astronaut text-light"></i>
                    <small class="text-light">{{ finished_rounds }} / {{ number_of_rounds }}</small>
                    <i class="fa-solid fa-circle-check text-light"></i>
                </div>
            </div>
        {% endfor %}

    </div>

{% endblock %}